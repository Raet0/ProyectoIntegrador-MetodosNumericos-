%% Cuadratura de Gauss-Legendre
function [integral, error] = gaussLegendre(funcionStr, a, b, n)
    % Entrada:
    %   funcionStr: string de la función
    %   a: límite inferior
    %   b: límite superior
    %   n: número de puntos de Gauss (2-10)
    % Salida:
    %   integral: valor aproximado
    %   error: estimación del error
    
    f = str2func(['@(x) ', funcionStr]);
    
    if n < 2 || n > 10
        fprintf('Error: n debe estar entre 2 y 10.\n');
        integral = [];
        error = [];
        return;
    end
    
    % Puntos y pesos de Gauss-Legendre
    switch n
        case 2
            puntos = [-0.5773502691896257, 0.5773502691896257];
            pesos = [1.0, 1.0];
        case 3
            puntos = [-0.7745966692414834, 0, 0.7745966692414834];
            pesos = [0.5555555555555556, 0.8888888888888888, 0.5555555555555556];
        case 4
            puntos = [-0.8611363115940526, -0.3399810435848563, 0.3399810435848563, 0.8611363115940526];
            pesos = [0.3478548451374538, 0.6521451548625461, 0.6521451548625461, 0.3478548451374538];
        case 5
            puntos = [-0.9061798459386640, -0.5384693101056831, 0, 0.5384693101056831, 0.9061798459386640];
            pesos = [0.2369268850561891, 0.4786286704993665, 0.5688888888888889, 0.4786286704993665, 0.2369268850561891];
        case 6
            puntos = [-0.9324695142031521, -0.6612093864662645, -0.2386191860831969, 0.2386191860831969, 0.6612093864662645, 0.9324695142031521];
            pesos = [0.1713244923791704, 0.3607615730481386, 0.4679139345726910, 0.4679139345726910, 0.3607615730481386, 0.1713244923791704];
        case 7
            puntos = [-0.9491079123427585, -0.7419860701469154, -0.4058451513773972, 0, 0.4058451513773972, 0.7419860701469154, 0.9491079123427585];
            pesos = [0.1294849661688696, 0.2797053914892766, 0.3818300505051889, 0.4179591836734694, 0.3818300505051889, 0.2797053914892766, 0.1294849661688696];
        case 8
            puntos = [-0.9602898564975363, -0.7966664774136267, -0.5255324099163290, -0.1834346424956498, 0.1834346424956498, 0.5255324099163290, 0.7966664774136267, 0.9602898564975363];
            pesos = [0.1012285362903763, 0.2223810344533745, 0.3137066458778873, 0.3626837833783620, 0.3626837833783620, 0.3137066458778873, 0.2223810344533745, 0.1012285362903763];
        case 9
            puntos = [-0.9681602395076261, -0.8360311073266358, -0.6133714327005904, -0.3242534234038089, 0, 0.3242534234038089, 0.6133714327005904, 0.8360311073266358, 0.9681602395076261];
            pesos = [0.0812743883615744, 0.1806481606948574, 0.2606106964029354, 0.3123470770400029, 0.3302393550012598, 0.3123470770400029, 0.2606106964029354, 0.1806481606948574, 0.0812743883615744];
        case 10
            puntos = [-0.9739065285171717, -0.8650633666889102, -0.6794095682990244, -0.4333953941292472, -0.1488391745338768, 0.1488391745338768, 0.4333953941292472, 0.6794095682990244, 0.8650633666889102, 0.9739065285171717];
            pesos = [0.0666713443086881, 0.1494513491505806, 0.2190863625159820, 0.2692567250960377, 0.2955242247147529, 0.2955242247147529, 0.2692567250960377, 0.2190863625159820, 0.1494513491505806, 0.0666713443086881];
    end
    
    % Cambio de variable de [-1,1] a [a,b]
    % x = ((b-a)*t + a + b) / 2
    integral_sum = 0;
    for i = 1:n
        t = puntos(i);
        x = ((b-a)*t + a + b) / 2;
        integral_sum = integral_sum + pesos(i) * f(x);
    end
    
    integral = (b - a) / 2 * integral_sum;
    error = 0; % Gauss-Legendre no proporciona error fácilmente
    
    fprintf('========== GAUSS-LEGENDRE ==========\n');
    fprintf('Función: f(x) = %s\n', funcionStr);
    fprintf('Intervalo: [%.4f, %.4f]\n', a, b);
    fprintf('Número de puntos: %d\n', n);
    fprintf('\nResultado:\n');
    fprintf('  Integral aproximada: %.10f\n', integral);
    fprintf('===================================\n');
end
